!function(t){"use strict";const e=new Intl.NumberFormat("en-US",{style:"currency",currency:"INR",minimumFractionDigits:0}),r=()=>{const e=t.select("svg");return{width:+e.attr("width"),height:+e.attr("height")}},s=(t,e)=>{const{colorValues:r,colorLabels:s,labelRectSize:a,labelSpacing:o,labelTextOffset:l,onColorClick:n,selectedColorValue:i,selectedConstituency:p}=e;t.selectAll(".tick").remove();const d=t.selectAll(".tick").data(r);d.exit().remove();const c=d.enter().append("g").attr("class","tick");c.merge(d).attr("transform",(t,e)=>`translate(0, ${e*o})`).attr("opacity",t=>!i||t===i||p?1:.2).on("click",t=>n(t===i?null:t)),c.append("rect").merge(d.select("rect")).attr("fill",(t,e)=>r[e]).attr("width",a).attr("height",a),c.append("text").merge(d.select("text")).text((t,e)=>s[e]).attr("dy","1.2em").attr("x",l)},a=(s,a)=>{const{longitude:o,latitude:l,scale:n,features:i,colorScale:p,selectedColorValue:d,onConstituencyClick:c,selectedConstituency:u,div:h,partyMap:y,selectedFeature:m}=a,g=s.selectAll("path").data(i,t=>t.properties.ASM_NAME),A=((e,s,a)=>{const o=t.geoMercator().scale(a).center([e,s]).translate([r().width/2,r().height/2]);return t.geoPath().projection(o)})(o,l,n),C=g.enter().append("path").attr("class","constituency").attr("d",A);"Top parties"===m?C.merge(g).attr("fill",t=>((t,e,r,s)=>{let a;return a=null===t.properties.Party||""===t.properties.Party?"black":r===t.properties.ASM_NAME?"yellow":s.hasOwnProperty(t.properties.Party)?e(t.properties.Party):e("Others")})(t,p,u,y)).attr("opacity",t=>((t,e,r,s,a)=>{let o;return o=r?r===s(t.properties.Party)?1:.2:1})(t,0,d,p)).classed("highlighted",t=>d&&d===p(t.properties.Party)).on("click",t=>c(t.properties.ASM_NAME===u?null:t.properties.ASM_NAME)).on("mouseover",t=>{h.transition().duration(300).style("opacity",.7),h.html("<p><strong>"+t.properties.ASM_NAME+"</strong></p><table><tbody><tr><td class='wide'>MLA:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){h.transition().duration(300).style("opacity",0)}):"Assets"===m?C.merge(g).attr("fill",t=>((t,e,r)=>{let s;return s=t.properties.Assets_num?r===t.properties.ASM_NAME?"yellow":e(t.properties.Assets_num):"black"})(t,p,u)).attr("opacity",t=>((t,e,r,s)=>{let a;return r?(a=r!=s(t.properties.Assets_num)?.2:1,null===t.properties.Assets_num&&(a=.2)):a=1,a})(t,0,d,p)).classed("highlighted",t=>d&&d===p(t.properties.Assets_num)).on("click",t=>c(t.properties.ASM_NAME===u?null:t.properties.ASM_NAME)).on("mouseover",t=>{h.transition().duration(300).style("opacity",.7),h.html("<p><strong>"+t.properties.ASM_NAME+"</strong></p><table><tbody><tr><td class='wide'>MLA:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Assets:</td><td>"+e.format(t.properties.Assets_num)+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){h.transition().duration(300).style("opacity",0)}):"Criminal Case(s)"===m?C.merge(g).attr("fill",t=>((t,e,r)=>{let s;return s=null===t.properties.Criminal_C?"black":r===t.properties.ASM_NAME?"yellow":e(t.properties.Criminal_C)})(t,p,u)).attr("opacity",t=>((t,e,r,s)=>{let a;return r?(a=r!=s(t.properties.Criminal_C)?.2:1,null===t.properties.Criminal_C&&(a=.2)):a=1,a})(t,0,d,p)).classed("highlighted",t=>d&&d===p(t.properties.Criminal_C)).on("click",t=>c(t.properties.ASM_NAME===u?null:t.properties.ASM_NAME)).on("mouseover",t=>{h.transition().duration(300).style("opacity",.7),h.html("<p><strong>"+t.properties.ASM_NAME+"</strong></p><table><tbody><tr><td class='wide'>MLA:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Criminal case(s):</td><td>"+t.properties.Criminal_C+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){h.transition().duration(300).style("opacity",0)}):"Education"===m&&C.merge(g).attr("fill",t=>((t,e,r)=>{let s;return s=null===t.properties.Criminal_C?"black":r===t.properties.ASM_NAME?"yellow":e(t.properties.edu)})(t,p,u)).attr("opacity",t=>((t,e,r,s)=>{let a;return r?(a=r!=s(t.properties.edu)?.2:1,0===t.properties.edu&&(a=.2)):a=1,a})(t,0,d,p)).classed("highlighted",t=>d&&d===p(t.properties.edu)).on("click",t=>c(t.properties.ASM_NAME===u?null:t.properties.ASM_NAME)).on("mouseover",t=>{h.transition().duration(300).style("opacity",.7),h.html("<p><strong>"+t.properties.ASM_NAME+"</strong></p><table><tbody><tr><td class='wide'>MLA:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Education:</td><td>"+t.properties.Education+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){h.transition().duration(300).style("opacity",0)})},o=(t,r)=>{const{selectedConstituency:s,selectedColorValue:a,features:o,colorValues:l,colorLabels:n,selectedFeature:i}=r,p=((t,r,s,a,o,l)=>{if(!t&&!r)return["Click on legend bar or Map"];if(t){const r=s.filter(e=>e.properties.ASM_NAME===t),a=r[0].properties.ASM_NAME,o=""===r[0].properties.Candidate?"No data":r[0].properties.Candidate,l=""===r[0].properties.Party?"No data":r[0].properties.Party,n=""===r[0].properties.Education?"No data":r[0].properties.Education,i=null===r[0].properties.Criminal_C?"No data":r[0].properties.Criminal_C;let p=null===r[0].properties.Assets_num?"No data":r[0].properties.Assets_num;return["Constituency: "+a,"MLA: "+o,p="No data"!=p?"Assets(Rs.): "+e.format(p):"Assets(Rs.): "+p,"Criminal case(s): "+i,"Education: "+n,"Party: "+l]}if(r){const t=a.indexOf(r);return"Assets"===l?[`MLA(s) with assets:  ${o[t]}`]:"Criminal Case(s)"===l?[`MLAs with ${o[t]} criminal case(s)`]:"Education"===l?[`MLAs with education:  ${o[t]}`]:"Top parties"===l?[`Constituencies won by: ${o[t]}`]:["This should not be displayed"]}})(s,a,o,l,n,i);t.selectAll("tspan").remove(),t.selectAll("tspan").data(p).enter().append("tspan").attr("x","0").attr("dy","1.5rem").text(t=>t)};let l,n,i,p,d,c,u,h="Assets";let y,m,g,A,C,f,M,b;const _=(t,e,r,s,a,o)=>{b=((t,e,r,s,a,o)=>{const l=e.reduce(function(t,e){return t.length>e.length?t:e});return{width:r+s+5*(o.length>l.length?o:l).length+s,height:a*(t.length+2)}})(t,e,r,s,a,o),(g=v.selectAll(".colorLegend").data([o])).exit().remove(),g=g.enter().append("g").merge(g).attr("class","colorLegend").attr("transform",`translate(10, ${x-b.height})`),(f=g.selectAll("rect").data([o])).exit().remove(),f.enter().append("rect").merge(f).attr("x",-r).attr("y",-r).attr("width",b.width).attr("height",b.height).attr("fill","red").attr("rx",r).attr("stroke","black").attr("stroke-width",1).attr("opacity",.3),(A=g.selectAll(".legendTitle").data([o])).exit().remove();const l=A.enter().append("g").merge(A).attr("class","legendTitle").selectAll("text").data([o]);l.enter().append("text").merge(l).text(o),(C=g.selectAll(".legendBody").data([o])).exit().remove(),M=C.enter().append("g").attr("transform",`translate(0, ${a/2})`).attr("class","legendBody").merge(C)};t.select("#menus").call((t,e)=>{const{options:r,onOptionClicked:s}=e;let a=t.selectAll("select").data([null]);const o=(a=a.enter().append("select").merge(a).on("change",function(){s(this.value)})).selectAll("option").data(r);o.enter().append("option").merge(o).attr("value",t=>t).text(t=>t)},{options:["Assets","Criminal Case(s)","Education","Top parties"],onOptionClicked:t=>{i=null,l=null,h=t,T(),$()}});const E=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),v=t.select("svg"),x=v.attr("height"),w=v.attr("width"),P=v.append("g"),k=v.append("g").attr("transform",`translate(${w-370-15},20)`),N=k.selectAll("rect").data([null]);N.enter().append("rect").merge(N).attr("width",370).attr("height",170).attr("fill","red").attr("stroke","black").attr("stroke-width",1).attr("rx",10).attr("opacity",.3);const S=k.selectAll("text").data([null]),L=S.enter().append("text").attr("class","infoText").attr("transform","translate(10,5)").merge(S);v.append("rect").attr("x",0).attr("y",0).attr("height",r().height).attr("width",r().width).style("stroke","black").style("fill","none").style("stroke-width",1);v.call(t.zoom().on("zoom",()=>{P.attr("transform",t.event.transform),E.attr("transform",t.event.transform)}));const T=()=>{"Top parties"===h?(d=["#43a2ca","#0868ac"],c=p=["AAP","BJP"],(u=t.scaleOrdinal()).domain(p).range(d),_(d,c,30,40,30,y="Top parties")):"Assets"===h?(u=t.scaleThreshold(),p=[1e7,1e8,5e8,1e9],d=["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],c=["< 1 Crore","1 - 10 Cr.","10 - 50 Cr.","50 - 100 Cr.","> 100 Cr."],u.domain(p).range(d),d.reverse(),c.reverse(),_(d,c,30,40,30,y="Assets(Rs.)")):"Criminal Case(s)"===h?(p=[1,3,9],d=["#edf8e9","#bae4b3","#74c476","#31a354"],c=["None","1 to 2","3 to 8","9 or more"],(u=t.scaleThreshold()).domain(p).range(d),d.reverse(),c.reverse(),_(d,c,30,40,30,y="Criminal Case(s)")):"Education"===h&&(p=[1,2,3,4],d=["#edf8e9","#bae4b3","#74c476","#238b45"],c=["Others","School","Graduate","Post Graduate"],(u=t.scaleOrdinal()).domain(p).range(d),d.reverse(),c.reverse(),_(d,c,30,40,30,y="Education"))},O=t=>{i&&(i=null),l=t,$()},V=t=>{l&&(l=null),i=t,$()};(e=>t.json(e).then(t=>{return t.features}))("https://raw.githubusercontent.com/saurabhp75/delhi_election_2020/master/data/merged_delhi_2020.json").then(t=>{(t=>{t.forEach(t=>{"Post Graduate"===t.properties.Education?t.properties.edu=4:"Graduate Professional"===t.properties.Education||"Graduate"===t.properties.Education?t.properties.edu=3:"12th Pass"===t.properties.Education||"10th Pass"===t.properties.Education||"8th Pass"===t.properties.Education||"5th Pass"===t.properties.Education?t.properties.edu=2:"Others"===t.properties.Education?t.properties.edu=1:t.properties.edu=0})})(n=t),m=(t=>{let e=t.reduce((t,e)=>{let r=e.properties.Party;return t.hasOwnProperty(r)||(t[r]=0),t[r]++,t},{}),r=[];for(let t in e)r.push([t,e[t]]);r.sort(function(t,e){return e[1]-t[1]}),r=r.slice(0,2);const s={};for(var a=0;a<r.length;++a)s[r[a][0]]=r[a][1];return s})(n),T(),$()});const $=()=>{P.call(a,{longitude:77.15,latitude:28.65,scale:6e4,features:n,colorScale:u,selectedColorValue:l,onConstituencyClick:V,selectedConstituency:i,div:E,partyMap:m,selectedFeature:h}),M.call(s,{colorValues:d,colorLabels:c,labelRectSize:30,labelSpacing:30,labelTextOffset:40,onColorClick:O,selectedColorValue:l,selectedConstituency:i,selectedFeature:h}),L.call(o,{selectedConstituency:i,selectedColorValue:l,features:n,colorValues:d,colorLabels:c,selectedFeature:h})}}(d3);
